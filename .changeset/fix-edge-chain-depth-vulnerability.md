---
"@ts-graphviz/ast": patch
---

Fix stack overflow vulnerability in edge chain parser

This patch addresses a security vulnerability where deeply chained edges in DOT files could cause stack overflow, leading to application crashes and potential DoS attacks.

**Changes:**
- Added depth limit (default: 1000) to edge chain parsing in PEG grammar
- Introduced `maxEdgeChainDepth` option to `parse()` function for custom depth limits
- Improved parser to track and limit edge chain depth during parsing
- Reset edge chain depth counter after successful edge parse

**Security Impact:**
- Prevents stack overflow attacks from maliciously crafted DOT files with deep edge chains (e.g., `a -> b -> c -> ... -> z`)
- Prevents memory exhaustion from unbounded `edgeops` array growth
- Normal use cases (typically <100 edges per chain) are unaffected
- Configurable limit allows complex graphs when needed

**Breaking Changes:**
None. This is a backward-compatible security fix with sensible defaults.
